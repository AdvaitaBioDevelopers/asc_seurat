.. _installation:

************
Installation
************

Dependencies
============

Asc-Seurat relies on multiple R packages and their dependencies (See :ref:`references`). However, we provide a Docker image that contains all necessary software and packages.

To install Asc-Seurat, you need to have Docker installed on your machine. Docker needs to be properly installed and configured in the user's machine. Check the installation instructions provided by Docker at https://docs.docker.com/engine/install.

Image download
--------------

After installing Docker, users can download the Docker image containing Asc-Seurat by executing the command below. The installation is quick and simple. After that, everything is setup.

.. code-block:: bash

    # Download the docker image:
    docker pull kirstlab/asc_seurat

After the installation is finished, you can start the app on your working directory. See below for the instructions on how to start the app in the different operational systems.

.. note::

    During the first execution, some folders will be created in your working directory. They include the folders :code:`data/` and :code:`RDS_files/` that you will use to store your datasets, allowing Asc-Seurat to read them.

    Always start the run inside your working directory to be able to use the data inside these folders.

Starting Asc-Seurat
===================

For macOS and Linux
-------------------

.. code-block:: bash

   # Create your working directory
   mkdir my_project
   cd my_project

   # Starts Asc-Seurat
   docker run -v $(pwd):/app/user_work -v /var/run/docker.sock:/var/run/docker.sock -d --name Asc_Seurat --rm -p 3838:3838 kirstlab/asc_seurat

   # Or with our custom script (https://github.com/KirstLab/asc_seurat/scripts/bscripts/run_server.sh)
   ./run_server.sh -s

If it does not open automatically, open your preferred web browser and paste the address http://localhost:3838/. Asc-Seurat should be ready.

If you want to kill the Docker container, run the command below.

.. code-block:: bash

   docker kill Asc_seurat

For Windows
-----------

To run Asc-Seurat on Windows via Docker it is necessary to use Windows 10. Moreover, Windows Subsystem for Linux (WSL) needs to be install. Before running Asc-Seurat, users need to guarantee that Docker and its WSL 2 components are properly installed and running. For that, check the two (sequential) tutorials below:

1. `Docker installation info <https://docs.docker.com/docker-for-windows/install/>`_
2. `Define windows WSL 2 as default <https://docs.microsoft.com/pt-br/windows/wsl/install-win10#step-5---set-wsl-2-as-your-default-version>`_

After certifying that everything is working, Asc-Seurat can be started with:

.. code-block:: bash

    # Create your working directory
    mkdir my_project
    cd my_project

    # If using Windows CMD
    docker run -v %cd%:/app/user_work -v /var/run/docker.sock:/var/run/docker.sock -d --rm -p 3838:3838 kirstlab/asc_seurat

    # If using Windows Powershell
    docker run -v ${PWD}:/app/user_work -v /var/run/docker.sock:/var/run/docker.sock -d --rm -p 3838:3838 kirstlab/asc_seurat

.. tip::

    Since Asc-Seurat relies on the directories :code:`data/` and :code:`RDS_files/` to access data generated by the user, creating one working directory for each project will help maintain the file organization.
